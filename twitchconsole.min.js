function addStreamsFromUrlHash(){var e=window.location.hash;var t=e.replace("#","").split(",");for(var n=0;n<t.length;n++){var r=t[n];if(r.length>0){addStreamAndChat(r,false)}}}function addStreamAndChat(e,t){if(t){if(!streamBoxIsEmpty()){window.location.hash+=","}window.location.hash+=e}addStream(e);addChat(e);$("#stream").val("");$("#welcome").hide();resizeChats();resizeStreams()}function removeStreamAndChat(e){window.location.hash=window.location.hash.replace("#"+e+",","#");window.location.hash=window.location.hash.replace("#"+e,"");window.location.hash=window.location.hash.replace(","+e,"");removeStream(e);removeChat("remove-chat-"+e);if(streamBoxIsEmpty()){$("#welcome").show()}}function addStream(e){var t="remove-"+e;var n='<span class="stream-listing">';n+='<input id="'+t+'" type="button" class="remove-stream" onclick="removeStreamAndChat(\''+e+'\');" value="Remove '+e+'" />';n+="</span>";$("#stream-list").append(n);$("#"+t).button({icons:{primary:"ui-icon-close"}});var r='<object id="'+e+'" type="application/x-shockwave-flash" height="255" width="400" class="stream" data=http://www.twitch.tv/widgets/live_embed_player.swf?channel='+e+'" bgcolor="#000000"><param name="allowFullScreen" value="true" /><param name="allowScriptAccess" value="always" /><param name="allowNetworking" value="all" /><param name="movie" value="http://www.twitch.tv/widgets/live_embed_player.swf" /><param name="flashvars" value="hostname=www.twitch.tv&channel='+e+'&auto_play=true&start_volume=0" /></object>';$("#active-streams").append(r)}function removeStream(e){$("#remove-"+e).parent().remove();$("#"+e).remove()}function addChat(e){var t=$("#chat-tabs").tabs();var n="chat-"+e;var r=$('<li><a href="#'+n+'">'+e+'</a><span id="remove-chat-'+e+'" class="ui-icon ui-icon-close" role="presentation">Remove Chat</span></li>');t.find(".ui-tabs-nav").append(r);var i='<div id="'+n+'" class="chat-container"></div>';t.append(i);var s='<iframe class="chat" frameborder="0" scrolling="no" src="http://twitch.tv/chat/embed?channel='+e+'&popout_chat=true" width="100%"></iframe>';$("#"+n).append(s);t.tabs("refresh");t.show();t.tabs("option","active",getChatBoxCount()-1)}function removeChat(e){removeTab(e);if(chatBoxIsEmpty()){$("#chat-tabs").tabs().hide();resizeStreams()}}function removeTab(e){var t=$("#"+e).closest("li").remove().attr("aria-controls");if(t){$("#"+t).remove();$("#chat-tabs").tabs("refresh")}}function getChatBoxCount(){return $("#chat-list").children("li").length}function chatBoxIsEmpty(){return getChatBoxCount()==0}function getStreamCount(){return $("#active-streams").children("object.stream").length}function streamBoxIsEmpty(){return getStreamCount()==0}function openHelp(){var e=$("#help").clone().dialog({title:"Help",modal:true,width:"500px",height:"auto",buttons:[{text:"Ok",click:function(){$(this).dialog("close")}}],close:function(){e.remove()}})}function openAbout(){$("#about").dialog("open")}function openDonate(){$("#donate").dialog("open")}function viewOnMultitwitch(){var e=window.location.hash.replace("#","");var t="http://www.multitwitch.tv/";var n=e.replace(/\,/g,"/");window.location=t+n}function toggleChat(){$("#chat-tabs").toggle();resizeStreams()}function chatIsVisible(){return $("#chat-tabs").is(":visible")}function toggleAd(e){if(adParamIsTrue()){window.location="?"+window.location.hash}else{window.location="?ad=true"+window.location.hash}}function adParamIsTrue(){return window.location.href.indexOf("ad=true")>-1}function resizeChats(){var e=$("body").height();var t=$("#topbar").height();if(adParamIsTrue()){t+=$("#chat-ad-container").height()}var n=$("#chat-list").height()+56;$(".chat").height(e-t-n)}function resizeStreams(){var e=$("body").height();var t=$("#topbar").height();var n=$("body").width();var r=0;if(chatIsVisible()||adParamIsTrue()){r=$("#chat-tabs-container").width()+parseInt($("#chat-tabs-container").css("right"))}var i=40;var s=n-r-i;var o=(e-t-i)/getStreamCount();$(".stream").height(o);$(".stream").width(s)}$(function(){if(!adParamIsTrue()){$("#chat-ad-container").empty().hide()}$(window).resize(function(){resizeChats();resizeStreams()});$("#add-stream").button();$("#chat-tabs").tabs({}).delegate("span.ui-icon-close","click",function(){removeChat($(this).attr("id"))}).hide();$("#about").dialog({title:"About",autoOpen:false,modal:true,width:"500px",height:"auto",buttons:[{text:"Ok",click:function(){$(this).dialog("close")}}]});$("#donate").dialog({title:"Donate",autoOpen:false,modal:true,width:"500px",height:"auto",buttons:[{text:"Ok",click:function(){$(this).dialog("close")}}]});addStreamsFromUrlHash()})